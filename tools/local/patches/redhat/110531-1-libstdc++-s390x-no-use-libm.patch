The s390x-ibm-tpf target does provide (or need) a math's library, but
without this patch the libstdc++-v3 library will include "-lm" on its
command line.

libstdc++-v3/ChangeLog
2008-08-28  Nick Clifton  <nickc@redhat.com>

	* configure.ac: Add test for s390*-*-tpf target and if we are
	building for this target set GLIBCXX_USE_LIBM to false.
	* configure: Regenerate.
	* src/Makefile.am (libstdc___la_LDFLAGS): Only add "-lm" to the
	linker command line if GLIBCXX_USE_LIBM is true.
	* src/Makefile.in: Regenerate.


Index: libstdc++-v3/configure
===================================================================
RCS file: /cvs/cvsfiles/gnupro/libstdc++-v3/configure,v
retrieving revision 1.59
diff -u -3 -p -r1.59 configure
--- libstdc++-v3/configure	27 Apr 2011 13:57:42 -0000	1.59
+++ libstdc++-v3/configure	31 May 2011 14:36:20 -0000
@@ -640,6 +640,8 @@ DOXYGEN
 BUILD_INFO_FALSE
 BUILD_INFO_TRUE
 baseline_dir
+GLIBCXX_USE_LIBM_FALSE
+GLIBCXX_USE_LIBM_TRUE
 GLIBCXX_LDBL_COMPAT_FALSE
 GLIBCXX_LDBL_COMPAT_TRUE
 ENABLE_VISIBILITY_FALSE
@@ -11496,7 +11498,7 @@ else
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<_LT_EOF
-#line 11499 "configure"
+#line 11501 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -11602,7 +11604,7 @@ else
   lt_dlunknown=0; lt_dlno_uscore=1; lt_dlneed_uscore=2
   lt_status=$lt_dlunknown
   cat > conftest.$ac_ext <<_LT_EOF
-#line 11605 "configure"
+#line 11607 "configure"
 #include "confdefs.h"
 
 #if HAVE_DLFCN_H
@@ -14964,7 +14966,7 @@ fi
     #
     # Fake what AC_TRY_COMPILE does.  XXX Look at redoing this new-style.
     cat > conftest.$ac_ext << EOF
-#line 14967 "configure"
+#line 14969 "configure"
 struct S { ~S(); };
 void bar();
 void foo()
@@ -15332,7 +15334,7 @@ $as_echo "$glibcxx_cv_atomic_long_long" 
   # Fake what AC_TRY_COMPILE does.
 
     cat > conftest.$ac_ext << EOF
-#line 15335 "configure"
+#line 15337 "configure"
 int main()
 {
   typedef bool atomic_type;
@@ -15369,7 +15371,7 @@ $as_echo "$glibcxx_cv_atomic_bool" >&6; 
     rm -f conftest*
 
     cat > conftest.$ac_ext << EOF
-#line 15372 "configure"
+#line 15374 "configure"
 int main()
 {
   typedef short atomic_type;
@@ -15406,7 +15408,7 @@ $as_echo "$glibcxx_cv_atomic_short" >&6;
     rm -f conftest*
 
     cat > conftest.$ac_ext << EOF
-#line 15409 "configure"
+#line 15411 "configure"
 int main()
 {
   // NB: _Atomic_word not necessarily int.
@@ -15444,7 +15446,7 @@ $as_echo "$glibcxx_cv_atomic_int" >&6; }
     rm -f conftest*
 
     cat > conftest.$ac_ext << EOF
-#line 15447 "configure"
+#line 15449 "configure"
 int main()
 {
   typedef long long atomic_type;
@@ -15520,7 +15522,7 @@ $as_echo "$as_me: WARNING: Performance o
   # unnecessary for this test.
 
     cat > conftest.$ac_ext << EOF
-#line 15523 "configure"
+#line 15525 "configure"
 int main()
 {
   _Decimal32 d1;
@@ -64532,6 +64534,13 @@ $as_echo "#define _GLIBCXX_LONG_DOUBLE_C
 esac
 
 
+ac_use_libm=yes
+case "$target" in
+  s390*-*-tpf)
+    ac_use_libm=no
+esac
+
+
 # This depends on GLIBCXX_ENABLE_SYMVERS and GLIBCXX_IS_NATIVE.
 
   if $GLIBCXX_IS_NATIVE ; then
@@ -65497,6 +65506,15 @@ else
 fi
 
 
+    if test $ac_use_libm = yes; then
+  GLIBCXX_USE_LIBM_TRUE=
+  GLIBCXX_USE_LIBM_FALSE='#'
+else
+  GLIBCXX_USE_LIBM_TRUE='#'
+  GLIBCXX_USE_LIBM_FALSE=
+fi
+
+
 
 
 cat >confcache <<\_ACEOF
@@ -65910,6 +65928,10 @@ if test -z "${GLIBCXX_LDBL_COMPAT_TRUE}"
   as_fn_error "conditional \"GLIBCXX_LDBL_COMPAT\" was never defined.
 Usually this means the macro was only invoked conditionally." "$LINENO" 5
 fi
+if test -z "${GLIBCXX_USE_LIBM_TRUE}" && test -z "${GLIBCXX_USE_LIBM_FALSE}"; then
+  as_fn_error "conditional \"GLIBCXX_USE_LIBM\" was never defined.
+Usually this means the macro was only invoked conditionally." "$LINENO" 5
+fi
 if test -z "${BUILD_INFO_TRUE}" && test -z "${BUILD_INFO_FALSE}"; then
   as_fn_error "conditional \"BUILD_INFO\" was never defined.
 Usually this means the macro was only invoked conditionally." "$LINENO" 5
Index: libstdc++-v3/configure.ac
===================================================================
RCS file: /cvs/cvsfiles/gnupro/libstdc++-v3/configure.ac,v
retrieving revision 1.25
diff -u -3 -p -r1.25 configure.ac
--- libstdc++-v3/configure.ac	11 Apr 2011 12:51:52 -0000	1.25
+++ libstdc++-v3/configure.ac	31 May 2011 14:36:20 -0000
@@ -325,6 +325,13 @@ case "$target" in
 esac
 GLIBCXX_CONDITIONAL(GLIBCXX_LDBL_COMPAT, test $ac_ldbl_compat = yes)
 
+ac_use_libm=yes
+case "$target" in
+  s390*-*-tpf)
+    ac_use_libm=no
+esac
+GLIBCXX_CONDITIONAL(GLIBCXX_USE_LIBM, test $ac_use_libm = yes)
+
 # This depends on GLIBCXX_ENABLE_SYMVERS and GLIBCXX_IS_NATIVE.
 GLIBCXX_CONFIGURE_TESTSUITE
 
Index: libstdc++-v3/src/Makefile.am
===================================================================
RCS file: /cvs/cvsfiles/gnupro/libstdc++-v3/src/Makefile.am,v
retrieving revision 1.21
diff -u -3 -p -r1.21 Makefile.am
--- libstdc++-v3/src/Makefile.am	25 Mar 2011 11:46:35 -0000	1.21
+++ libstdc++-v3/src/Makefile.am	31 May 2011 14:36:22 -0000
@@ -250,8 +250,13 @@ libstdc___la_DEPENDENCIES = \
 	${version_dep} \
 	$(top_builddir)/libsupc++/libsupc++convenience.la
 
+if GLIBCXX_USE_LIBM
 libstdc___la_LDFLAGS = \
-	-version-info $(libtool_VERSION) ${version_arg} -lm
+	-version-info $(libtool_VERSION) ${version_arg} -lm 
+else
+libstdc___la_LDFLAGS = \
+	-version-info $(libtool_VERSION) ${version_arg} 
+endif
 
 libstdc___la_LINK = $(CXXLINK) $(libstdc___la_LDFLAGS)
 
Index: libstdc++-v3/src/Makefile.in
===================================================================
RCS file: /cvs/cvsfiles/gnupro/libstdc++-v3/src/Makefile.in,v
retrieving revision 1.28
diff -u -3 -p -r1.28 Makefile.in
--- libstdc++-v3/src/Makefile.in	25 Mar 2011 11:46:35 -0000	1.28
+++ libstdc++-v3/src/Makefile.in	31 May 2011 14:36:22 -0000
@@ -465,8 +465,11 @@ libstdc___la_DEPENDENCIES = \
 	${version_dep} \
 	$(top_builddir)/libsupc++/libsupc++convenience.la
 
-libstdc___la_LDFLAGS = \
-	-version-info $(libtool_VERSION) ${version_arg} -lm
+@GLIBCXX_USE_LIBM_FALSE@libstdc___la_LDFLAGS = \
+@GLIBCXX_USE_LIBM_FALSE@	-version-info $(libtool_VERSION) ${version_arg} 
+
+@GLIBCXX_USE_LIBM_TRUE@libstdc___la_LDFLAGS = \
+@GLIBCXX_USE_LIBM_TRUE@	-version-info $(libtool_VERSION) ${version_arg} -lm 
 
 libstdc___la_LINK = $(CXXLINK) $(libstdc___la_LDFLAGS)
 
