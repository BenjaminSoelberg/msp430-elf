# PSIM altivec vperm testcase
# mach: altivec
# as(altivecle): -mlittle
# ld(altivecle): -EL

	.include "testutils.inc"

	start

	.data
	.p2align 4

	# example from AltiVec PEM
a_foo:	# v2
	.byte 0x0,  0x1,  0x2,  0x3,  0x4,  0x5,  0x6,  0x7
	.byte 0x8,  0x9,  0xa,  0xb,  0xc,  0xd,  0xe,  0xf
b_foo:	# v3
	.byte 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17
	.byte 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f
c_foo:	# v4
	.byte 0x1,  0x14, 0x18, 0x10, 0x16, 0x15, 0x19, 0x1a
	.byte 0x1c, 0x1c, 0x1c, 0x13, 0x8,  0x1d, 0x1e, 0x0e

	.text
	.global vperm
vperm:
	load_vr		%v2, %r3, a_foo
	load_vr		%v3, %r3, b_foo
	load_vr		%v4, %r3, c_foo

	vperm		%v9, %v2, %v3, %v4
	vcmpequw.	%v10, %v9, %v4
	bc		12, 24, pass

fail:
	fail

pass:
	pass
